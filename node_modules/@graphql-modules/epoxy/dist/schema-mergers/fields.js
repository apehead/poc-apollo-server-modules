"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var utils_1 = require("./utils");
var directives_1 = require("./directives");
function fieldAlreadyExists(fieldsArr, otherField) {
    var result = fieldsArr.find(function (field) { return field.name.value === otherField.name.value; });
    if (result) {
        var t1 = utils_1.extractType(result.type);
        var t2 = utils_1.extractType(otherField.type);
        if (t1.name.value !== t2.name.value) {
            throw new Error("Field \"" + otherField.name.value + "\" already defined with a different type. Declared as \"" + t1.name.value + "\", but you tried to override with \"" + t2.name.value + "\"");
        }
    }
    return !!result;
}
function mergeFields(f1, f2) {
    var e_1, _a;
    var result = tslib_1.__spread(f2);
    var _loop_1 = function (field) {
        if (fieldAlreadyExists(result, field)) {
            var existing = result.find(function (f) { return f.name.value === field.name.value; });
            existing['directives'] = directives_1.mergeDirectives(field['directives'], existing['directives']);
        }
        else {
            result.push(field);
        }
    };
    try {
        for (var f1_1 = tslib_1.__values(f1), f1_1_1 = f1_1.next(); !f1_1_1.done; f1_1_1 = f1_1.next()) {
            var field = f1_1_1.value;
            _loop_1(field);
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (f1_1_1 && !f1_1_1.done && (_a = f1_1.return)) _a.call(f1_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return result;
}
exports.mergeFields = mergeFields;
//# sourceMappingURL=fields.js.map